<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Account Slide and Visibility</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>HEADER</header>
  <main>
    <div class="hover-area"></div>
    <div class="inverse-hover-area"></div>
    <div class="account-wrapper">
      <div class="account-text">AccOUnT nAME</div>
      <div class="account-text">L1nK UP</div>
      <div class="account-text">. . .</div>
      <div class="account-text">0</div>
      <div class="account-line"></div>
    </div>
  </main>

  <script>
    // Constants
    const HIDE_MIN = 6.37, HIDE_MAX = 28.86;
    const TOP_MIN  = 11,   TOP_MAX  = 40;
    const SLIDE_AMOUNT = 60; // in vw
    const SLIDE_DURATION = 700; // ms

    // Helpers
    const pxToVw = px => (px / window.innerWidth) * 100;
    const pxToVh = px => (px / window.innerHeight) * 100;

    // Targets
    const targets = [
      ...document.querySelectorAll('.account-text'),
      document.querySelector('.account-line'),
    ];

    // Improved visibility check
    function updateVisibility() {
      targets.forEach(el => {
        const rect     = el.getBoundingClientRect();
        const leftVw   = pxToVw(rect.left);
        const rightVw  = pxToVw(rect.right);
        const topVh    = pxToVh(rect.top);

        const hideH = leftVw <= HIDE_MAX && rightVw >= HIDE_MIN;
        const hideV = topVh  >= TOP_MIN  && topVh   <= TOP_MAX;
        const hide  = hideH && hideV;

        el.style.opacity       = hide ? '0' : '';
        el.style.pointerEvents = hide ? 'none' : '';
      });
    }

    // Initial visibility and resize listener
    updateVisibility();
    window.addEventListener('resize', updateVisibility);

    // Sliding logic with continuous visibility updates
    const slideInTrigger  = document.querySelector('.hover-area');
    const slideOutTrigger = document.querySelector('.inverse-hover-area');
    let sliding = false;

    function startSlide(direction) {
      if (sliding) return;
      sliding = true;

      // Continuous update loop
      function tick() {
        updateVisibility();
        if (sliding) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);

      // Move elements
      targets.forEach(el => {
        const curLeft = pxToVw(el.getBoundingClientRect().left);
        const op      = direction > 0 ? '+' : '-';
        el.style.left = `calc(${curLeft}vw ${op} ${SLIDE_AMOUNT}vw)`;
      });

      // End slide after duration
      setTimeout(() => {
        sliding = false;
        updateVisibility();
      }, SLIDE_DURATION);
    }

    slideInTrigger.addEventListener('mouseenter', () => startSlide(1));
    slideOutTrigger.addEventListener('mouseenter', () => startSlide(-1));
  </script>
</body>
</html>
